[%- PROCESS "statistics/macros-header.tt" -%]

[%- MACRO country_entry(country) BLOCK -%]
<tr[% ' class="ev"' IF loop.count % 2 == 0 %]>
    <td class="r">[% loop.count %]</td>
    [%- IF country.entity.country_code != '' -%]
    <td>[% link_entity(country.entity) %]</td>
    [%- ELSE -%]
    <td>[% l('Unknown Country') %]</td>
    [%- END -%]
    <td class="r">[% link_entity(country.entity, 'artists', add_commas(country.artist_count)) %]</td>
    <td class="r">[% link_entity(country.entity, 'releases', add_commas(country.release_count)) %]</td>
    <td class="r">[% link_entity(country.entity, 'labels', add_commas(country.label_count)) %]</td>
    <td class="r">[% add_commas(country.artist_count + country.release_count + country.label_count) %]</td>
</tr>
[%- END -%]

[% WRAPPER 'statistics/layout.tt' title=l('Countries') full_width=1 page='countries' %]

<h2>[% l('Countries') %]</h2>
<table class="tbl">
<thead>
<tr>
<th class="pos">[% l('Rank') %]</th>
<th>[% l('Country') %]<div class="arrow"></div></th>
<th>[% l('Artists') %]<div class="arrow"></div></th>
<th>[% l('Releases') %]<div class="arrow"></div></th>
<th>[% l('Labels') %]<div class="arrow"></div></th>
<th>[% l('Total') %]<div class="arrow"></div></th>
</tr>
</thead>
<tbody>
[%- FOREACH country IN countries -%]
[%- country_entry(country) -%]
[%- END -%]
</tbody>
</table>
[%- last_updated_stats -%]
[%- PROCESS "statistics/macros-footer.tt" -%]

<script type="text/javascript">//<![CDATA[
  MB.Control.Tablesorter($('table.tbl'), {
      widgets: [ 'indexFirstColumn', 'evenRowClasses' ],
      headers: { 0: {sorter: false}, 2: { sorter: 'fancyNumber' }, 3: { sorter: 'fancyNumber' }, 4: { sorter: 'fancyNumber' }, 5: { sorter: 'fancyNumber' } },
      sortList: [ [5,1], [1,0] ] // order by descending number of entities, then name
     });
//]]></script>

[% END %]
